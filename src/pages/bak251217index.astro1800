---
// src/pages/index.astro
import Layout from '../layouts/Layout.astro';
import { CITIES, getCharset } from '../utils/cityBases';

const projectDate = "251216";
const base128 = getCharset('BASE128');

// æ¨¡æ‹Ÿ Base16384 çš„éƒ¨åˆ†å¸¸ç”¨æ±‰å­—ç”¨äºå±•ç¤º
const chineseSample = "çš„ä¸€æ˜¯åœ¨ä¸äº†æœ‰å’Œäººè¿™ä¸­å¤§ä¸ºä¸Šä¸ªå›½æˆ‘ä»¥è¦ä»–æ—¶æ¥ç”¨ä»¬ç”Ÿåˆ°ä½œåœ°äºå‡ºå°±åˆ†å¯¹æˆä¼šå¯ä¸»å‘å¹´åŠ¨åŒå·¥ä¹Ÿèƒ½ä¸‹è¿‡å­è¯´äº§ç§é¢è€Œæ–¹åå¤šå®šè¡Œå­¦æ³•æ‰€æ°‘å¾—ç»åä¸‰ä¹‹è¿›ç€ç­‰éƒ¨åº¦å®¶ç”µåŠ›é‡Œå¦‚æ°´åŒ–é«˜è‡ªäºŒç†èµ·å°ç‰©ç°å®åŠ é‡éƒ½ä¸¤ä½“åˆ¶æœºå½“ä½¿ç‚¹ä»ä¸šæœ¬å»æŠŠæ€§å¥½åº”å¼€å®ƒåˆè¿˜å› ç”±å…¶äº›ç„¶å‰å¤–å¤©æ”¿å››æ—¥é‚£ç¤¾ä¹‰äº‹å¹³å½¢ç›¸å…¨è¡¨é—´æ ·ä¸å…³å„é‡æ–°çº¿å†…æ•°æ­£å¿ƒåä½ æ˜çœ‹åŸåˆä¹ˆåˆ©æ¯”æˆ–ä½†è´¨æ°”ç¬¬å‘é“å‘½æ­¤å˜æ¡åªæ²¡ç»“è§£é—®æ„å»ºæœˆå…¬æ— ç³»å†›å¾ˆæƒ…è€…æœ€ç«‹ä»£æƒ³å·²é€šå¹¶æç›´é¢˜å…šç¨‹å±•äº”æœæ–™è±¡å‘˜é©ä½å…¥å¸¸æ–‡æ€»æ¬¡å“å¼æ´»è®¾åŠç®¡ç‰¹ä»¶é•¿æ±‚è€å¤´åŸºèµ„è¾¹æµè·¯çº§å°‘å›¾å±±ç»Ÿæ¥çŸ¥è¾ƒå°†ç»„è§è®¡åˆ«å¥¹æ‰‹è§’æœŸæ ¹è®ºè¿å†œæŒ‡å‡ ä¹åŒºå¼ºæ”¾å†³è¥¿è¢«å¹²åšå¿…æˆ˜å…ˆå›åˆ™ä»»å–å®Œä¸¾ç§‘æˆ˜æ³¨è€…æœ€";

const cities = [
  { name: "Base2 (äºŒè¿›åˆ¶åŸ)", charset: CITIES.BASE2, desc: "è®¡ç®—æœºçš„åŸºçŸ³" },
  { name: "Base4 (DNAåŸ)", charset: CITIES.BASE4, desc: "åŸºå› ç¼–ç çš„åŸºç¡€" },
  { name: "Base8 (å…«è¿›åˆ¶åŸ)", charset: CITIES.BASE8, desc: "æ—©æœŸçš„å­—èŠ‚åˆ†ç»„" },
  { name: "Base16 (åå…­è¿›åˆ¶åŸ)", charset: CITIES.BASE16, desc: "å†…å­˜åœ°å€çš„è¯­è¨€" },
  { name: "Ai-Base32 (æ ¸å¿ƒåŸ)", charset: CITIES.BASE32, desc: "Ai32.org çš„å¿ƒè„ã€‚å‰”é™¤æ··æ·†å­—ç¬¦ï¼Œä¼˜åŒ–å¤§å°å†™ã€‚", highlight: true },
  { name: "Ai-Base64 (ä¼ è¾“åŸ)", charset: CITIES.BASE64, desc: "ç½‘ç»œä¼ è¾“æ ‡å‡†ï¼ŒQ64 é€šé“å…¥å£ã€‚" },
  { name: "Ai-Base128 (ASCIIåŸ)", charset: base128.substring(0, 100) + "...", desc: "å…¼å®¹æ‰€æœ‰ ASCII é”®ç›˜å­—ç¬¦ã€‚Q128 é€šé“å…¥å£ã€‚" },
  { name: "Ai-Base16384 (æ±‰å­—ä¸»åŸ)", charset: chineseSample.substring(0, 100) + "...", desc: "å›Šæ‹¬ã€Šé€šç”¨è§„èŒƒæ±‰å­—è¡¨ã€‹ä¸€çº§ã€äºŒçº§ã€ä¸‰çº§å­—ã€‚" },
];
---

<Layout title={`Ai32.org - Project ${projectDate}`}>
  <main class="min-h-screen bg-slate-900 text-slate-100 font-mono selection:bg-purple-500 selection:text-white">
    
    <header class="p-8 border-b border-slate-800 bg-slate-950/50 backdrop-blur-md sticky top-0 z-50">
      <div class="max-w-7xl mx-auto flex justify-between items-center">
        <div>
          <h1 class="text-4xl font-bold bg-gradient-to-r from-cyan-400 to-purple-500 text-transparent bg-clip-text">
            Ai32.org
          </h1>
          <p class="text-slate-400 text-sm mt-1">Project {projectDate} | Dynamic Base System</p>
        </div>
        <div class="text-xs text-slate-500 text-right">
          <p>Loc: Amherst, MA</p>
          <p>Dev: Astro on Coolify</p>
        </div>
      </div>
    </header>

    <section class="max-w-7xl mx-auto p-8 my-8">
      <div class="bg-slate-800/50 rounded-2xl p-8 border border-slate-700 shadow-2xl">
        <h2 class="text-2xl font-bold mb-6 text-cyan-300">âš¡ å®æ—¶ç¼–ç è½¬æ¢å™¨</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div>
            <label class="block text-sm text-slate-400 mb-2">è¾“å…¥æ•°å­— (Base10)</label>
            <input type="number" id="input-num" value="251216" 
              class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-xl focus:ring-2 focus:ring-cyan-500 outline-none transition" />
          </div>
          <div class="space-y-4">
             <div class="p-4 bg-slate-900 rounded-lg border border-slate-700 flex justify-between items-center">
                <span class="text-purple-400">Ai-Base32</span>
                <span id="out-32" class="text-2xl font-bold tracking-wider text-white">Calculating...</span>
             </div>
             <div class="p-4 bg-slate-900 rounded-lg border border-slate-700 flex justify-between items-center">
                <span class="text-blue-400">Ai-Base64</span>
                <span id="out-64" class="text-xl font-bold tracking-wider text-white">Calculating...</span>
             </div>
          </div>
        </div>
      </div>
    </section>

    <section class="max-w-7xl mx-auto p-8">
      <h2 class="text-3xl font-bold mb-10 flex items-center gap-3">
        <span>ğŸ™ï¸</span> The Digital Cities
      </h2>
      
      <div class="grid gap-8">
        {cities.map((city) => (
          <div class={`relative overflow-hidden rounded-xl border p-6 transition hover:shadow-lg ${city.highlight ? 'bg-slate-800/80 border-cyan-500/50 shadow-cyan-900/20' : 'bg-slate-900 border-slate-800'}`}>
            <div class="flex flex-col md:flex-row gap-6">
              <div class="md:w-1/4">
                <h3 class={`text-xl font-bold ${city.highlight ? 'text-cyan-300' : 'text-slate-200'}`}>{city.name}</h3>
                <p class="text-slate-400 text-sm mt-2">{city.desc}</p>
                {city.name.includes("Base32") && (
                   <span class="inline-block mt-3 px-2 py-1 bg-cyan-900/30 text-cyan-400 text-xs rounded border border-cyan-800">å½“å‰ç‰ˆæœ¬æ ¸å¿ƒ</span>
                )}
              </div>
              <div class="md:w-3/4">
                <div class="font-mono text-sm break-all leading-relaxed tracking-widest text-slate-300 bg-black/20 p-4 rounded-lg border border-white/5">
                  {city.charset.split('').map(char => (
                    <span class="inline-block hover:text-white hover:scale-150 transition-transform cursor-default px-[1px]">{char}</span>
                  ))}
                </div>
                {city.name.includes("Base128") && <div class="mt-2 text-xs text-slate-500">* å±•ç¤ºéƒ¨åˆ† ASCII æ‰©å±•</div>}
                {city.name.includes("Base16384") && <div class="mt-2 text-xs text-slate-500">* ä»…å±•ç¤ºå‰ 300 å¸¸ç”¨æ±‰å­—ï¼Œå®Œæ•´é›†åŒ…å« 8105 ä¸ªè§„èŒƒæ±‰å­—</div>}
              </div>
            </div>
          </div>
        ))}
      </div>
    </section>

    <footer class="text-center py-12 text-slate-600 text-sm border-t border-slate-900 mt-12">
      <p>System developed in Amherst, MA (01002).</p>
      <p>&copy; 2025 Ai32.org. All Bases Belong To Us.</p>
    </footer>

  </main>
</Layout>

<script>
  // Client-side Logic
  import { CITIES, toBase } from '../utils/cityBases';
  
  const input = document.getElementById('input-num') as HTMLInputElement;
  const out32 = document.getElementById('out-32');
  const out64 = document.getElementById('out-64');

  function update() {
    const val = parseInt(input.value) || 0;
    if(out32) out32.innerText = toBase(val, CITIES.BASE32);
    if(out64) out64.innerText = toBase(val, CITIES.BASE64);
  }

  input?.addEventListener('input', update);
  update(); // init
</script>
