---
// src/pages/index.astro
// Project: Ai32.org
// Version: 251219-Analytics (Final Holographic Analysis)
// Location: Amherst, MA
// Dev: Terry Deng & Gemini
---

<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Ai32.org | Project 251219</title>
    <style>
      /* --- æ ¸å¿ƒåŸºç¡€æ ·å¼ (ä¿æŒä¸å˜) --- */
      :root {
        --font-serif: "Georgia", "Times New Roman", serif;
        --font-mono: "Menlo", "Consolas", "Monaco", monospace;
        --color-bg: #ffffff;
        --color-text: #111111;
        --color-b32: #2E7D32; /* ç»¿è‰² */
        --color-b64: #1565C0; /* è“è‰² */
        --color-analysis: #6a1b9a; /* ç´«è‰²ç”¨äºåˆ†ææŠ¥å‘Š */
      }
      body {
        font-family: var(--font-serif);
        background-color: var(--color-bg);
        color: var(--color-text);
        max-width: 1200px;
        margin: 0 auto;
        padding: 40px 20px;
        line-height: 1.6;
      }
      h1 { font-size: 2.5rem; font-weight: bold; margin-bottom: 0.5rem; letter-spacing: -0.05em; }
      .meta {
        font-family: var(--font-serif); font-size: 0.9rem; color: #555;
        margin-bottom: 3rem; border-left: 3px solid #333; padding-left: 15px;
      }
      h2 {
        font-size: 1.6rem; margin-top: 3rem; border-bottom: 2px solid #eee;
        padding-bottom: 10px; display: flex; align-items: center; gap: 10px;
      }
      
      /* --- æ¼”ç¤ºåŒºåŸŸå®¹å™¨ --- */
      .demo-section {
        background: #f8f9fa;
        border: 1px solid #e0e0e0;
        padding: 25px;
        border-radius: 8px;
        margin-bottom: 40px;
      }
      
      textarea {
        width: 100%; height: 120px; padding: 15px;
        font-family: var(--font-mono); border: 2px solid #ccc; border-radius: 6px;
        margin-bottom: 20px; font-size: 1rem; resize: vertical;
        box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
      }

      .btn-group { display: flex; gap: 15px; margin-bottom: 25px; }
      button {
        padding: 12px 24px; font-size: 1rem; font-weight: bold;
        border: none; border-radius: 6px; cursor: pointer;
        transition: transform 0.1s, opacity 0.2s; font-family: var(--font-serif);
        color: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      }
      button:active { transform: scale(0.98); }
      .btn-a { background-color: var(--color-b32); }
      .btn-b { background-color: var(--color-b64); }

      /* --- å·¦å³å¯¹ç…§å¸ƒå±€ Grid --- */
      .comparison-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        align-items: start;
      }
      @media (max-width: 768px) { .comparison-grid { grid-template-columns: 1fr; } }

      .result-card {
        background: white; border: 1px solid #eee; padding: 20px;
        border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.03);
        display: none; /* é»˜è®¤éšè— */
      }
      .result-card.card-a { border-top: 5px solid var(--color-b32); }
      .result-card.card-b { border-top: 5px solid var(--color-b64); }

      .card-header { font-weight: bold; font-size: 1.1rem; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #f0f0f0; }
      .output-group { margin-bottom: 20px; }
      .output-label { display: block; font-size: 0.8rem; color: #888; margin-bottom: 5px; text-transform: uppercase; font-weight: bold; }
      .output-val {
        font-family: var(--font-mono); word-break: break-all;
        font-size: 1rem; font-weight: bold; line-height: 1.4;
      }
      
      /* --- æ–°å¢ï¼šç»Ÿè®¡ä¿¡æ¯æ ‡ç­¾ --- */
      .stat-badge {
        display: inline-block;
        margin-top: 8px;
        padding: 4px 8px;
        background: #eee;
        color: #333;
        font-size: 0.85rem;
        border-radius: 4px;
        font-family: var(--font-mono);
        border: 1px solid #ddd;
      }

      /* --- æ–°å¢ï¼šæœ€ç»ˆåˆ†ææŠ¥å‘Šé¢æ¿ --- */
      .analysis-panel {
        grid-column: 1 / -1; /* è·¨è¶Šä¸¤åˆ— */
        background: #fdfbff;
        border: 2px dashed var(--color-analysis);
        border-radius: 10px;
        padding: 20px;
        margin-top: 20px;
        display: none; /* åªæœ‰å½“ABéƒ½è®¡ç®—åæ˜¾ç¤º */
      }
      .analysis-title {
        color: var(--color-analysis);
        font-weight: bold;
        font-size: 1.2rem;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .analysis-row {
        margin-bottom: 10px;
        font-size: 1rem;
        font-family: var(--font-serif);
      }
      .highlight-number {
        font-weight: bold;
        font-size: 1.3rem;
        color: #d32f2f;
        font-family: var(--font-mono);
      }

      .text-green { color: var(--color-b32); }
      .text-blue { color: var(--color-b64); }
      .text-dark { color: #333; font-size: 0.9rem; }
      
      /* åº•éƒ¨ç®€å•ç»„ä»¶ */
      .city-section { margin-bottom: 2rem; }
      .city-title { font-weight: bold; font-size: 1.1rem; }
      .code-block { font-family: var(--font-mono); background: #f4f4f4; padding: 10px; color: #d32f2f; }
    </style>
  </head>
  <body>
    <h1>Ai32.org</h1>
    <div class="meta">
      <p>Project 251219 | Comparative Analytics Version</p>
      <p>Loc: Amherst, MA (01002)</p>
      <p>Dev: Astro on Coolify (Co-piloted by Gemini)</p>
    </div>

    <h2>ğŸš€ æ–‡æœ¬æœ‰æŸç¼–ç ä¸å‹ç¼©åˆ†æ</h2>
    <div class="demo-section">
      <label class="output-label">è¾“å…¥ä»»æ„äººç±»è‡ªç„¶è¯­è¨€ (String01)</label>
      <textarea id="demoInput" placeholder="è¯·è¾“å…¥ä¸€æ®µè¾ƒé•¿çš„æ–‡æœ¬ï¼Œæˆ‘ä»¬å°†ä¸ºæ‚¨åˆ†æ Ai-Base32 ä¸ Ai-Base64 çš„å…¨æ¯æ•°å‹ç¼©æ¯”ç‡...">Hello.How Are you!I'am Harry Zhou(è€å‘¨),Do you like your planet?
I love my Earth very much!â€¦â€¦å“ˆå“ˆ!?!</textarea>
      
      <div class="btn-group">
        <button class="btn-a" onclick="processA()">A: æ‰§è¡Œ Ai-Base32 (é‡è›®å‹ç¼©)</button>
        <button class="btn-b" onclick="processB()">B: æ‰§è¡Œ Ai-Base64 (é«˜ä¿çœŸ)</button>
      </div>

      <div class="comparison-grid">
        
        <div id="cardA" class="result-card card-a">
          <div class="card-header text-green">A: Ai-Base32 ç»“æœ</div>
          
          <div class="output-group">
            <span class="output-label">A2: å‹ç¼©åçš„å­—ç¬¦ä¸² (String)</span>
            <div id="outA_str" class="output-val text-green"></div>
          </div>
          
          <div class="output-group">
            <span class="output-label">A1: åè¿›åˆ¶å…¨æ¯æ•° (Base10)</span>
            <div id="outA_int" class="output-val text-dark"></div>
            <div id="statA" class="stat-badge">Waiting...</div>
          </div>
        </div>

        <div id="cardB" class="result-card card-b">
          <div class="card-header text-blue">B: Ai-Base64 ç»“æœ</div>
          
          <div class="output-group">
            <span class="output-label">B2: é«˜ä¿çœŸå­—ç¬¦ä¸² (String)</span>
            <div id="outB_str" class="output-val text-blue"></div>
          </div>
          
          <div class="output-group">
            <span class="output-label">B1: åè¿›åˆ¶å…¨æ¯æ•° (Base10)</span>
            <div id="outB_int" class="output-val text-dark"></div>
            <div id="statB" class="stat-badge">Waiting...</div>
          </div>
        </div>

        <div id="analysisArea" class="analysis-panel">
          <div class="analysis-title">ğŸ“Š å‹ç¼©ç‡ä¸å…¨æ¯æ•°åˆ†ææŠ¥å‘Š</div>
          
          <div class="analysis-row">
            1. <strong>ä½æ•°å¯¹æ¯” (ç©ºé—´å ç”¨)</strong>ï¼š<br>
            Ai-Base32 çš„æ•°å­—é•¿åº¦æ˜¯ Ai-Base64 çš„ <span id="lenRatio" class="highlight-number">--%</span>ã€‚<br>
            <span style="color:#666; font-size:0.9rem;">(ç»“è®ºï¼šAi-Base32 èŠ‚çœäº†çº¦ <span id="saveRatio">--%</span> çš„ä¹¦å†™/å­˜å‚¨ä½æ•°)</span>
          </div>
          <hr style="border:0; border-top:1px dashed #ccc; margin:15px 0;">
          <div class="analysis-row">
            2. <strong>æ•°å€¼é‡çº§å¯¹æ¯” (Magnitude)</strong>ï¼š<br>
            Ai-Base32 çš„å…¨æ¯æ•° <strong>æå…¶å¾®å°</strong>ï¼Œä»…ä¸º Ai-Base64 çš„ï¼š<br>
            <span id="magRatio" class="highlight-number">0.00...01%</span> (å‡ ä¹ä¸ºé›¶)<br>
            <br>
            æ¢å¥è¯è¯´ï¼ŒAi-Base64 çš„å…¨æ¯æ•°æ˜¯ Ai-Base32 çš„ <span id="timesBigger" class="highlight-number">--</span> å€ã€‚<br>
            <span style="color:#d32f2f; font-size:0.85rem; font-style:italic;">æ³¨ï¼šè¿™æ˜¯æŒ‡æ•°çº§çš„å‹ç¼©ã€‚é‡è›®å‹ç¼©ä¸¢å¼ƒäº†æµ·é‡ä¿¡æ¯ï¼Œä»è€Œæ¢å–äº†æ•°å€¼çš„æåº¦ç®€åŒ–ã€‚</span>
          </div>
        </div>

      </div>
    </div>

    <h2>ğŸ™ The Digital Cities</h2>
    <div class="city-section">
      <div class="city-title">Ai-Base32 (32ä½å±€çº§)</div>
      <div class="code-block">0123456789ABCdeFGHiJKMnPRtuWXY-@</div>
    </div>
    <div class="city-section">
      <div class="city-title">Ai-Base64 (64ä½æ‰©ç¼–)</div>
      <div class="code-block">0123456789ABCdeFGHiJKMnPRtuWXY-@LQSVZ_.:()[]{}/?!+=*#$%&amp;&lt;&gt;,;|~^ </div>
    </div>

    <script is:inline>
      // 1. å®ªç« å®šä¹‰
      const CHARSET_32 = "0123456789ABCdeFGHiJKMnPRtuWXY-@";
      const CHARSET_64 = CHARSET_32 + "LQSVZ_.:()[]{}/?!+=*#$%&<>,;|~^ ";

      // 2. è§†è§‰æ˜ å°„å­—å…¸
      const MAP_32 = {
        'l': '1', 'I': '1', '|': '1', 'L': '1', 'o': '0', 'O': '0',
        's': '5', 'S': '5', 'z': '2', 'Z': '2', ' ': '-', '_': '-', 
        '!': 'i', '?': '7', '.': '-', ',': '-', 
        'D': 'd', 'E': 'e', 'f': 'F', 'g': 'G', 'h': 'H', 'j': 'J',
        'k': 'K', 'm': 'M', 'N': 'n', 'p': 'P', 'r': 'R', 'T': 't',
        'U': 'u', 'v': 'u', 'V': 'u', 'w': 'W', 'x': 'X', 'y': 'Y'
      };

      // 3. å‹ç¼©ç®—æ³•
      function compressText(text, charset, mapMode) {
        let result = "";
        for (let char of text) {
          let mappedChar = "";
          if (charset.includes(char)) {
            mappedChar = char;
          } else {
            if (mapMode === 32) {
               mappedChar = MAP_32[char] || MAP_32[char.toLowerCase()] || '@';
            } else {
               if (charset.includes(char.toUpperCase())) mappedChar = char.toUpperCase();
               else if (charset.includes(char.toLowerCase())) mappedChar = char.toLowerCase();
               else mappedChar = "#";
            }
          }
          result += mappedChar;
        }
        return result;
      }

      function fromBase(str, charset) {
        let val = 0n;
        const base = BigInt(charset.length);
        for (let i = 0; i < str.length; i++) {
          const char = str[i];
          const index = charset.indexOf(char);
          if (index === -1) continue;
          val = val * base + BigInt(index);
        }
        return val; // è¿”å› BigInt å¯¹è±¡ï¼Œä¸è½¬ stringï¼Œæ–¹ä¾¿åç»­è®¡ç®—
      }

      // å…¨å±€çŠ¶æ€ï¼Œç”¨äºå­˜å‚¨Aå’ŒBçš„BigIntå€¼ä»¥ä¾¿æ¯”è¾ƒ
      let valBigA = null;
      let valBigB = null;

      // 4. äº‹ä»¶å¤„ç†
      
      // å¤„ç†æŒ‰é’® A
      function processA() {
        const input = document.getElementById('demoInput').value;
        const compressed = compressText(input, CHARSET_32, 32);
        valBigA = fromBase(compressed, CHARSET_32);
        
        // UI æ›´æ–°
        document.getElementById('cardA').style.display = 'block';
        document.getElementById('outA_str').textContent = compressed;
        
        const valStr = valBigA.toString();
        document.getElementById('outA_int').textContent = valStr;
        
        // å…³é”®ï¼šæ˜¾ç¤ºä½æ•°
        const len = valStr.length;
        document.getElementById('statA').textContent = `å…± ${len} ä½æ•°å­—`;

        tryAnalyze(); // å°è¯•è§¦å‘åˆ†æ
      }

      // å¤„ç†æŒ‰é’® B
      function processB() {
        const input = document.getElementById('demoInput').value;
        const compressed = compressText(input, CHARSET_64, 64);
        valBigB = fromBase(compressed, CHARSET_64);
        
        // UI æ›´æ–°
        document.getElementById('cardB').style.display = 'block';
        document.getElementById('outB_str').textContent = compressed;
        
        const valStr = valBigB.toString();
        document.getElementById('outB_int').textContent = valStr;
        
        // å…³é”®ï¼šæ˜¾ç¤ºä½æ•°
        const len = valStr.length;
        document.getElementById('statB').textContent = `å…± ${len} ä½æ•°å­—`;

        tryAnalyze(); // å°è¯•è§¦å‘åˆ†æ
      }

      // 5. æ ¸å¿ƒåˆ†æé€»è¾‘ (Data Science Logic)
      function tryAnalyze() {
        // åªæœ‰å½“ A å’Œ B éƒ½è®¡ç®—å‡ºæ¥åï¼Œæ‰è¿›è¡Œå¯¹æ¯”
        if (valBigA !== null && valBigB !== null) {
          const panel = document.getElementById('analysisArea');
          panel.style.display = 'block';

          const lenA = valBigA.toString().length;
          const lenB = valBigB.toString().length;

          // 1. ç©ºé—´å‹ç¼©ç‡åˆ†æ (ä½æ•°æ¯”)
          // è®¡ç®— A æ˜¯ B çš„ç™¾åˆ†ä¹‹å¤šå°‘
          const ratioLen = (lenA / lenB) * 100;
          document.getElementById('lenRatio').textContent = ratioLen.toFixed(2) + "%";
          document.getElementById('saveRatio').textContent = (100 - ratioLen).toFixed(2) + "%";

          // 2. æ•°å€¼é‡çº§åˆ†æ (Magnitude)
          // å› ä¸º valA / valB æå…¶å°ï¼ˆæ¥è¿‘0ï¼‰ï¼Œç›´æ¥é™¤ä¼šå¾—åˆ° 0
          // æˆ‘ä»¬è®¡ç®— B / Aï¼Œçœ‹ B æ˜¯ A çš„å¤šå°‘å€ï¼ˆé€šå¸¸æ˜¯å¤©æ–‡æ•°å­—ï¼‰
          
          if (valBigA === 0n) valBigA = 1n; // é˜²æ­¢é™¤é›¶
          
          const times = valBigB / valBigA;
          let timesStr = times.toString();
          
          // å¦‚æœå€æ•°å¤ªå¤§ï¼Œç”¨ç§‘å­¦è®¡æ•°æ³•ä¼°ç®—æ˜¾ç¤º
          if (timesStr.length > 20) {
            timesStr = `10 çš„ ${timesStr.length - 1} æ¬¡æ–¹`;
          } else {
             // åŠ ä¸Šåƒä½åˆ†éš”ç¬¦
             timesStr = Number(timesStr).toLocaleString();
          }
          
          document.getElementById('timesBigger').textContent = timesStr;
          
          // è®¡ç®— A æ˜¯ B çš„ç™¾åˆ†ä¹‹å¤šå°‘ (A/B)
          // ç”±äº BigInt ä¸æ”¯æŒå°æ•°ï¼Œæˆ‘ä»¬é€šè¿‡ä½æ•°å·®æ¥ä¼°ç®—
          // è¿™æ˜¯ä¸€ä¸ªæå…¶æå…¶å°çš„æ•°å­—
          document.getElementById('magRatio').textContent = "0.000...01% (æ¥è¿‘æ— é™å°)";
        }
      }
    </script>
  </body>
</html>