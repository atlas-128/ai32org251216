---
// src/pages/index.astro
// Project: Ai32.org
// Version: 251218-Demo (Enhanced for Investor Demo)
// Location: Amherst, MA
// Dev: Terry Deng & Gemini
---

<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Ai32.org | Project 251218</title>
    <style>
      /* --- æç®€ä¸»ä¹‰è®¾è®¡é£æ ¼ (Terry's Style) --- */
      :root {
        --font-serif: "Georgia", "Times New Roman", serif;
        --font-mono: "Menlo", "Consolas", "Monaco", monospace;
        --color-bg: #ffffff;
        --color-text: #111111;
        --color-accent: #d32f2f;
        --color-b32: #2E7D32; /* ç»¿è‰² */
        --color-b64: #1565C0; /* è“è‰² */
      }
      body {
        font-family: var(--font-serif);
        background-color: var(--color-bg);
        color: var(--color-text);
        max-width: 900px; /* ç¨å¾®åŠ å®½ä»¥å®¹çº³æ¼”ç¤º */
        margin: 0 auto;
        padding: 40px 20px;
        line-height: 1.6;
      }
      h1 {
        font-size: 2.5rem;
        font-weight: bold;
        margin-bottom: 0.5rem;
        letter-spacing: -0.05em;
      }
      .meta {
        font-family: var(--font-serif);
        font-size: 0.9rem;
        color: #555;
        margin-bottom: 3rem;
        border-left: 2px solid #333;
        padding-left: 15px;
      }
      h2 {
        font-size: 1.5rem;
        margin-top: 3rem;
        border-bottom: 2px solid #eee;
        padding-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 10px;
      }
      
      /* --- æ¼”ç¤ºåŒºåŸŸæ ·å¼ --- */
      .demo-box {
        background: #f8f9fa;
        border: 1px solid #e0e0e0;
        padding: 25px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      }
      
      textarea {
        width: 100%;
        height: 100px;
        padding: 10px;
        font-family: var(--font-mono);
        border: 1px solid #ccc;
        border-radius: 4px;
        margin-bottom: 15px;
        font-size: 0.95rem;
        resize: vertical;
      }

      .btn-group {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
      }

      button {
        padding: 10px 20px;
        font-size: 1rem;
        font-weight: bold;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: opacity 0.2s;
        font-family: var(--font-serif);
      }
      button:hover { opacity: 0.9; }
      
      .btn-a { background-color: var(--color-b32); color: white; }
      .btn-b { background-color: var(--color-b64); color: white; }

      .output-card {
        background: white;
        border: 1px solid #eee;
        padding: 15px;
        border-radius: 6px;
        margin-bottom: 15px;
      }
      .output-card.b32-card { border-left: 5px solid var(--color-b32); }
      .output-card.b64-card { border-left: 5px solid var(--color-b64); }

      .output-label {
        display: block;
        font-size: 0.85rem;
        color: #777;
        margin-bottom: 5px;
        text-transform: uppercase;
        font-weight: bold;
      }
      
      .output-val {
        font-family: var(--font-mono);
        word-break: break-all;
        font-size: 1.1rem;
        font-weight: bold;
      }
      
      .b32-text { color: var(--color-b32); }
      .b64-text { color: var(--color-b64); }
      .int-text { color: #333; font-size: 0.9rem; }

      /* --- ç°æœ‰æ ·å¼ä¿ç•™ --- */
      .city-section { margin-bottom: 2rem; }
      .city-title { font-weight: bold; font-size: 1.1rem; }
      .city-desc { font-size: 0.95rem; color: #444; margin-bottom: 0.5rem; }
      .code-block {
        font-family: var(--font-mono);
        background: #f4f4f4;
        padding: 10px;
        border-radius: 4px;
        word-break: break-all;
        font-size: 0.9rem;
        color: var(--color-accent);
      }
      
      /* ç®€å•çš„åˆ†å‰²çº¿ */
      hr { border: 0; border-top: 1px solid #eee; margin: 3rem 0; }
    </style>
  </head>
  <body>
    <h1>Ai32.org</h1>
    <div class="meta">
      <p>Project 251218 | Dynamic Base System</p>
      <p>Loc: Amherst, MA (01002)</p>
      <p>Dev: Astro on Coolify (Co-piloted by Gemini)</p>
    </div>

    <h2>ğŸš€ æ–‡æœ¬æœ‰æŸç¼–ç ä¸å‹ç¼©æ¼”ç¤º</h2>
    <div class="demo-box">
      <label class="output-label">è¾“å…¥ä»»æ„äººç±»è‡ªç„¶è¯­è¨€ (String01)</label>
      <textarea id="demoInput" placeholder="è¾“å…¥ä¸€æ®µè¯ï¼Œä¾‹å¦‚ï¼šHello! How are you...">Hello! How Are you. I' am Terry Deng(è€é‚“),What's your name?Do you like your Father?I love your Motherâ€¦â€¦å“ˆå“ˆ!?!</textarea>
      
      <div class="btn-group">
        <button class="btn-a" onclick="processA()">A: è½¬ Ai-Base32 (é‡è›®å‹ç¼©)</button>
        <button class="btn-b" onclick="processB()">B: è½¬ Ai-Base64 (é«˜ä¿çœŸ)</button>
      </div>

      <div id="resultAreaA" style="display:none;">
        <div class="output-card b32-card">
          <div style="margin-bottom:15px;">
            <span class="output-label">A2: Ai-Base32 å‹ç¼©ç¼–ç  (String)</span>
            <div id="outA_str" class="output-val b32-text"></div>
            <small style="color:#999">æ³¨ï¼šæŸå¤±äº†å¤§å°å†™ã€æ ‡ç‚¹ï¼Œéƒ¨åˆ†å­—ç¬¦è¢«å¼ºåˆ¶è½¬ä¹‰æˆ–æ›¿æ¢ä¸º @</small>
          </div>
          <div>
            <span class="output-label">A1: å¯¹åº”çš„åè¿›åˆ¶å…¨æ¯æ•° (Base10 Integer)</span>
            <div id="outA_int" class="output-val int-text"></div>
          </div>
        </div>
      </div>

      <div id="resultAreaB" style="display:none;">
        <div class="output-card b64-card">
          <div style="margin-bottom:15px;">
            <span class="output-label">B2: Ai-Base64 é«˜ä¿çœŸç¼–ç  (String)</span>
            <div id="outB_str" class="output-val b64-text"></div>
            <small style="color:#999">æ³¨ï¼šä¿ç•™äº†ç»å¤§éƒ¨åˆ†æ ‡ç‚¹å’Œè¯­ä¹‰ï¼Œä½¿ç”¨äº†æ‰©å±•å­—ç¬¦é›†</small>
          </div>
          <div>
            <span class="output-label">B1: å¯¹åº”çš„åè¿›åˆ¶å…¨æ¯æ•° (Base10 Integer)</span>
            <div id="outB_int" class="output-val int-text"></div>
          </div>
        </div>
      </div>
    </div>

    <hr>

    <h2>âš¡ï¸ æ ‡å‡†æ•°å­—è½¬æ¢å™¨ (Base10 Input)</h2>
    <div class="demo-box" style="background:white;">
      <label class="output-label" for="numInput">è¾“å…¥çº¯æ•°å­— (Base10)</label>
      <input type="number" id="numInput" value="251218" style="width:100%; padding:8px; font-family:monospace; font-size:1.1rem; border:1px solid #ccc;" />
      
      <div style="margin-top:20px;">
        <div class="output-label">Ai-Base32 Result</div>
        <div id="output32" class="output-val b32-text">...</div>
      </div>
      <div style="margin-top:10px;">
        <div class="output-label">Ai-Base64 Result</div>
        <div id="output64" class="output-val b64-text">...</div>
      </div>
    </div>

    <h2>ğŸ™ The Digital Cities</h2>

    <div class="city-section">
      <div class="city-title">Ai-Base32 (æ ¸å¿ƒåŸ - 32ä½å±€çº§)</div>
      <div class="city-desc">
        è§†è§‰é›¶æ··æ·†ã€‚å‰”é™¤ L,O,Q,S,V,Z,_ã€‚ä¿ç•™ - (å‡å·)ï¼Œå¼•å…¥ @ã€‚
      </div>
      <div class="code-block">0123456789ABCdeFGHiJKMnPRtuWXY-@</div>
    </div>

    <div class="city-section">
      <div class="city-title">Ai-Base64 (ä¼ è¾“åŸ - 64ä½æ‰©ç¼–)</div>
      <div class="city-desc">
        é«˜å¯†åº¦ä¼ è¾“ã€‚ç©ºæ ¼ (Space) ä½äºæœ€åä¸€ä½ (Index 63)ã€‚
      </div>
      <div class="code-block">0123456789ABCdeFGHiJKMnPRtuWXY-@LQSVZ_.:()[]{}/?!+=*#$%&amp;&lt;&gt;,;|~^ </div>
    </div>

    <script is:inline>
      // ==========================================
      // 1. Ai32.org251218 å®ªç« å®šä¹‰
      // ==========================================
      const CHARSET_32 = "0123456789ABCdeFGHiJKMnPRtuWXY-@";
      // æ‰©å±•åŒºï¼šLQSVZ_.:()[]{}/?!+=*#$%&<>,;|~^ (æœ€åä¸€ä½æ˜¯ç©ºæ ¼)
      const EXTENSION_64 = "LQSVZ_.:()[]{}/?!+=*#$%&<>,;|~^ ";
      const CHARSET_64 = CHARSET_32 + EXTENSION_64;

      // ==========================================
      // 2. è§†è§‰æ˜ å°„å­—å…¸ (Visual Homoglyph Map)
      //    è¿™é‡Œæ˜¯æ ¸å¿ƒé»‘ç§‘æŠ€ï¼šæŠŠäººç±»è¯­è¨€â€œæœ‰æŸâ€æ˜ å°„åˆ° Ai-Base å­—ç¬¦é›†
      // ==========================================
      
      // æ˜ å°„åˆ° Base32 (æå…¶é‡è›®)
      const MAP_32 = {
        'l': '1', 'I': '1', '|': '1', 'L': '1',
        'o': '0', 'O': '0',
        's': '5', 'S': '5', 'z': '2', 'Z': '2',
        ' ': '-', '_': '-', // ç©ºæ ¼è½¬å‡å·
        '!': 'i', // å¹å·è½¬ i
        '?': '7', // é—®å·è½¬ 7
        '.': '-', // ç‚¹è½¬å‡å·
        ',': '-', 
        // å¤§å†™è½¬æ ‡å‡†
        'D': 'd', 'E': 'e', 'f': 'F', 'g': 'G', 'h': 'H', 'j': 'J',
        'k': 'K', 'm': 'M', 'N': 'n', 'p': 'P', 'r': 'R', 'T': 't',
        'U': 'u', 'v': 'u', 'V': 'u', 'w': 'W', 'x': 'X', 'y': 'Y'
      };

      // æ˜ å°„åˆ° Base64 (ç›¸å¯¹æ¸©æŸ”ï¼Œåªè½¬å¤§å°å†™)
      // æ³¨æ„ï¼šBase64 åŒ…å«äº†å¤§éƒ¨åˆ†æ ‡ç‚¹ï¼Œæ‰€ä»¥ä¸éœ€è¦å¤ªå¤šæ˜ å°„
      // æˆ‘ä»¬ä¸»è¦å¤„ç†é‚£äº›ä¸åœ¨è¡¨é‡Œçš„å­—ç¬¦
      
      // ==========================================
      // 3. ç®—æ³•å‡½æ•°
      // ==========================================

      // æ ¸å¿ƒç®—æ³•ï¼šå°†ä»»æ„æ–‡æœ¬â€œå‹ç¼©â€ä¸ºåˆæ³•çš„ BaseX å­—ç¬¦ä¸²
      function compressText(text, charset, mapMode) {
        let result = "";
        for (let char of text) {
          let mappedChar = "";
          
          // æ­¥éª¤ A: æ£€æŸ¥å­—ç¬¦æ˜¯å¦åŸç”Ÿå°±åœ¨ Charset é‡Œ
          if (charset.includes(char)) {
            mappedChar = char;
          } 
          // æ­¥éª¤ B: å¦‚æœä¸åœ¨ï¼Œå°è¯•æŸ¥å­—å…¸ (è§†è§‰æ˜ å°„)
          else {
            if (mapMode === 32) {
               // Base32 æ¨¡å¼ï¼šæŸ¥å­—å…¸ï¼ŒæŸ¥ä¸åˆ°å°±ç»™ '@' (è½¬ä¹‰/æœªçŸ¥)
               mappedChar = MAP_32[char] || MAP_32[char.toLowerCase()] || '@';
            } else {
               // Base64 æ¨¡å¼ï¼š
               // å°è¯•æ‰¾å¤§å†™/å°å†™æ›¿èº« (Case Folding)
               // æ¯”å¦‚ 'q' ä¸åœ¨è¡¨é‡Œ(å‡è®¾), æ‰¾ 'Q'
               // Ai-Base64 é‡Œ 'Q' åœ¨è¡¨é‡Œ (Index 33)
               // æˆ‘ä»¬çš„è¡¨ä¸­: 0-31 æ··åˆäº†å¤§å°å†™ã€‚
               // ç®€å•ç­–ç•¥ï¼šå¦‚æœ char ä¸åœ¨è¡¨é‡Œï¼Œçœ‹çœ‹å®ƒçš„ upper æˆ– lower åœ¨ä¸åœ¨
               if (charset.includes(char.toUpperCase())) mappedChar = char.toUpperCase();
               else if (charset.includes(char.toLowerCase())) mappedChar = char.toLowerCase();
               else mappedChar = "#"; // Base64 ä¸­æœªçŸ¥å­—ç¬¦ç”¨ # æˆ–å…¶ä»–å ä½
            }
          }
          result += mappedChar;
        }
        return result;
      }

      // æ ¸å¿ƒç®—æ³•ï¼šå°† BaseX å­—ç¬¦ä¸² è§£ç ä¸º BigInt (Base10)
      function fromBase(str, charset) {
        let val = 0n;
        const base = BigInt(charset.length);
        for (let i = 0; i < str.length; i++) {
          const char = str[i];
          const index = charset.indexOf(char);
          if (index === -1) continue; // å¿½ç•¥éæ³•å­—ç¬¦
          val = val * base + BigInt(index);
        }
        return val.toString();
      }

      // æ ¸å¿ƒç®—æ³•ï¼šå°† Base10 è½¬å› BaseX (ç”¨äºä¸‹æ–¹çš„è½¬æ¢å™¨)
      function toBase(num, charset) {
        if (num === "" || isNaN(num)) return "";
        let n = BigInt(num);
        if (n < 0n) return "Error";
        if (n === 0n) return charset[0];
        let result = "";
        const base = BigInt(charset.length);
        while (n > 0n) {
          const remainder = n % base;
          result = charset[Number(remainder)] + result;
          n = n / base;
        }
        return result;
      }

      // ==========================================
      // 4. DOM äº‹ä»¶å¤„ç†
      // ==========================================

      function processA() {
        const input = document.getElementById('demoInput').value;
        // 1. å‹ç¼©
        const compressed = compressText(input, CHARSET_32, 32);
        // 2. è®¡ç®—æ•°å€¼
        const bigIntVal = fromBase(compressed, CHARSET_32);
        
        // 3. æ˜¾ç¤º
        document.getElementById('resultAreaA').style.display = 'block';
        document.getElementById('resultAreaB').style.display = 'none';
        
        document.getElementById('outA_str').textContent = compressed;
        document.getElementById('outA_int').textContent = bigIntVal;
      }

      function processB() {
        const input = document.getElementById('demoInput').value;
        // 1. å‹ç¼© (Mode 64)
        const compressed = compressText(input, CHARSET_64, 64);
        // 2. è®¡ç®—æ•°å€¼
        const bigIntVal = fromBase(compressed, CHARSET_64);
        
        // 3. æ˜¾ç¤º
        document.getElementById('resultAreaB').style.display = 'block';
        document.getElementById('resultAreaA').style.display = 'none';
        
        document.getElementById('outB_str').textContent = compressed;
        document.getElementById('outB_int').textContent = bigIntVal;
      }

      // åº•éƒ¨åŸæœ‰è½¬æ¢å™¨çš„é€»è¾‘
      const inputEl = document.getElementById('numInput');
      const out32El = document.getElementById('output32');
      const out64El = document.getElementById('output64');

      function updateBottom() {
        const val = inputEl.value;
        out32El.textContent = toBase(val, CHARSET_32);
        out64El.textContent = toBase(val, CHARSET_64);
      }
      inputEl.addEventListener('input', updateBottom);
      updateBottom(); // init
    </script>
  </body>
</html>